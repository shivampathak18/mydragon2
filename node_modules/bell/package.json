{
  "name": "bell",
  "description": "Third-party login plugin for hapi",
  "version": "2.2.0",
  "repository": {
    "type": "git",
    "url": "git://github.com/hapijs/bell"
  },
  "main": "index",
  "keywords": [
    "hapi",
    "login",
    "authentication",
    "oauth",
    "plugin",
    "twitter",
    "facebook",
    "google",
    "yahoo",
    "live",
    "windows",
    "microsoft",
    "github",
    "foursquare",
    "vk"
  ],
  "engines": {
    "node": ">=0.10.33"
  },
  "dependencies": {
    "boom": "2.x.x",
    "cryptiles": "2.x.x",
    "hoek": "2.x.x",
    "joi": "5.x.x",
    "wreck": "5.x.x"
  },
  "peerDependencies": {
    "hapi": ">=8.x.x"
  },
  "devDependencies": {
    "hapi": "8.x.x",
    "hawk": "2.x.x",
    "lab": "5.x.x",
    "code": "1.x.x"
  },
  "scripts": {
    "test": "make test-cov"
  },
  "licenses": [
    {
      "type": "BSD",
      "url": "http://github.com/hapijs/bell/raw/master/LICENSE"
    }
  ],
  "readme": "### **bell**\n\n**bell** is a third-party login plugin for [hapi](https://github.com/hapijs/hapi). **bell** ships with built-in support for Facebook, GitHub,\nGoogle, Instagram, Twitter, Yahoo, Foursquare, VK, and Windows Live. It also supports any compliant OAuth 1.0a and 2.0 based login services with a simple\nconfiguration object.\n\n[![Build Status](https://secure.travis-ci.org/hapijs/bell.png)](http://travis-ci.org/hapijs/bell)\n\nLead Maintainer: [Wyatt Preul](https://github.com/wpreul)\n\n### Usage\n\n**bell** works by adding a login endpoint and setting it to use a **bell**-based authentication strategy. **bell** will manage the third-party\nauthentication flow and will only call the handler if the user successfully authenticated. The handler function is then used to examine the\nthird-party credentials (e.g. lookup an existing account or offer a registration page), setup an active session, and redirect to the actual\napplication.\n\n**bell** does not maintain a session beyond a temporary state between the authorization flow. If a user authenticated once when accessing the\nendpoint, they will have to authenticate again. This means **bell** cannot be used alone as a login system except for single-page applications\nthat require loading a single resource. Once the handler is called, the application must set its own session management. A common solution is to\ncombine **bell** with the [**hapi-auth-cookie**](https://github.com/hapijs/hapi-auth-cookie) authentication scheme plugin.\n\n```javascript\nvar Hapi = require('hapi');\nvar server = new Hapi.Server(8000);\n\n// Register bell with the server\nserver.register(require('bell'), function (err) {\n\n    // Declare an authentication strategy using the bell scheme\n    // with the name of the provider, cookie encryption password,\n    // and the OAuth client credentials.\n    server.auth.strategy('twitter', 'bell', {\n        provider: 'twitter',\n        password: 'cookie_encryption_password',\n        clientId: 'my_twitter_client_id',\n        clientSecret: 'my_twitter_client_secret',\n        isSecure: false     // Terrible idea but required if not using HTTPS\n    });\n\n    // Use the 'twitter' authentication strategy to protect the\n    // endpoint handling the incoming authentication credentials.\n    // This endpoints usually looks up the third party account in\n    // the database and sets some application state (cookie) with\n    // the local application account information.\n    server.route({\n        method: ['GET', 'POST'], // Must handle both GET and POST\n        path: '/login',          // The callback endpoint registered with the provider\n        config: {\n            auth: 'twitter',\n            handler: function (request, reply) {\n\n                // Perform any account lookup or registration, setup local session,\n                // and redirect to the application. The third-party credentials are\n                // stored in request.auth.credentials. Any query parameters from\n                // the initial request are passed back via request.auth.credentials.query.\n                return reply.redirect('/home');\n            }\n        }\n    });\n\n    server.start();\n});\n```\n\n### Options\n\nThe `server.auth.strategy()` method requires the following strategy options:\n- `provider` - the name of the third-party provider (`'bitbucket'`, `'dropbox'`, `'facebook'`, `'foursquare'`, `'github'`, `'google'`, `'instagram'`, `'live'`, `'twitter'`, `'vk'`, `'yahoo'`)\n  or an object containing a custom provider with the following:\n    - `protocol` - the authorization protocol used. Must be one of:\n        - `'oauth'` - OAuth 1.0a\n        - `'oauth2'` - OAuth 2.0\n    - `temporary` - the temporary credentials (request token) endpoint (OAuth 1.0a only).\n    - `auth` - the authorization endpoint URI.\n    - `token` - the access token endpoint URI.\n    - `version` - the OAuth version.\n    - `scope` - an array of scope strings (OAuth 2.0 only).\n    - `scopeSeparator` - the scope separator character (OAuth 2.0 only). Only required when a provider has a broken OAuth 2.0 implementation.\n      Defaults to space (Facebook and GitHub default to comma).\n    - `headers` - a headers object with additional headers required by the provider (e.g. GitHub required the 'User-Agent' header which is\n      set by default).\n    - `profile` - a function used to obtain user profile information and normalize it. The function signature is\n      `function(credentials, params, get, callback)` where:\n        - `credentials` - the credentials object. Change the object directly within the function (profile information is typically stored\n          under `credentials.profile`).\n        - `params` - the parsed information received from the provider (e.g. token, secret, and other custom fields).\n        - `get` - an OAuth helper function to make authenticated requests using the credentials received. The `get` function signature\n          is `function(uri, params, callback)` where:\n            - `uri` - the requested resource URI (**bell** will add the token or authentication header as needed).\n            - `params` - any URI query parameters (cannot include them in the URI due to signature requirements).\n            - `callback` - request callback with signature `function(response)` where `response` is the parsed payload (any errors are\n              handled internally).\n        - `callback` - the callback function which much be called once profile processing is complete.\n- `password` - the cookie encryption password. Used to encrypt the temporary state cookie used by the module in between the authorization\n  protocol steps.\n- `clientId` - the OAuth client identifier (consumer key).\n- `clientSecret` - the OAuth client secret (consumer secret).\n- `forceHttps` - A boolean indicating whether or not you want the redirect_uri to be forced to https. Useful if your hapi application runs as http, but is accessed through https.\n\nEach strategy accepts the following optional settings:\n- `cookie` - the name of the cookie used to manage the temporary state. Defaults to `'bell-provider'` where 'provider' is the provider name\n  (or `'custom'` for custom providers). For example, the Twitter cookie name defaults to `'bell-twitter'`.\n- `isSecure` - sets the cookie secure flag. Defaults to `true`.\n- `isHttpOnly` - sets the cookie HTTP only flag. Defaults to `true`.\n- `ttl` - cookie time-to-live in milliseconds. Defaults to `null` (session time-life - cookies are deleted when the browser is closed).\n- `domain` - the domain scope. Defaults to `null` (no domain).\n- `providerParams` - provider-specific query parameters for the authentication endpoint. Each provider supports its own set of parameters\n  which customize the user's login experience. For example:\n    - Facebook supports `display` ('page', 'popup', or 'touch'), `auth_type`, `auth_nonce`.\n    - Google supports `access_type`, `approval_prompt`, `prompt`, `login_hint`, `user_id`, `hd`.\n    - Twitter supports `force_login`, `screen_name`.\n- `scope` - Each built-in vendor comes with the required scope for basic profile information. Use `scope` to specify a different scope\n  as required by your application. Consult the provider for their specific supported scopes.\n- `config` - a configuration object used to customize the provider settings. The built-in `'twitter'` provider accepts the `extendedProfile`\n  option which allows disabling the extra profile request when the provider returns the user information in the callback (defaults to `true`).\n  The built-in `'github'` provider accepts the `uri` option which allows pointing to a private enterprise installation\n  (e.g. `'https://vpn.example.com'`).\n- `profileParams` - an object of key-value pairs that specify additional URL query parameters to send with the profile request to the provider.\n   The built-in `facebook` provider, for example, could have `fields` specified to determine the fields returned from the user's graph, which would\n   then be available to you in the `auth.credentials.profile.raw` object.\n\n### Advanced Usage\n\n#### Handling Errors\n\nBy default, **bell** will reply back with an internal error (500) on most authentication errors due to the nature of the OAuth protocol.\nThere is little that can be done to recover from errors as almost all of them are caused by implementation or deployment issues.\n\nIf you would like to display a useful error page instead of the default JSON response, use the **hapi**\n[`onPreResponse`](https://github.com/hapijs/hapi/blob/master/docs/Reference.md#error-transformation) extension point to transform the\nerror into a useful page or to redirect the user to another destination.\n\nAnother way to handle authentication errors is within the route handler. By default, an authentication error will cause the handler to be\nskipped. However, if the authentication mode is set to `'try'` instead of `'required'`, the handler will still be called. In this case,\nthe `request.auth.isAuthenticated` must be checked to test if authentication failed. In that case, `request.auth.error` will contain the error.\n\n#### Token Refresh\n\nTo keep track of the token expiry time, `request.auth.credentials.expiresIn` provides you the duration (in seconds) after which you could send a refresh token request using the `request.auth.credentials.refreshToken` to get a new token.\n\n```javascript\nvar Hapi = require('hapi');\nvar server = new Hapi.Server(8000);\n\n// Register bell with the server\nserver.register(require('bell'), function (err) {\n\n    server.auth.strategy('twitter', 'bell', {\n        provider: 'twitter',\n        password: 'cookie_encryption_password',\n        clientId: 'my_twitter_client_id',\n        clientSecret: 'my_twitter_client_secret'\n    });\n\n    server.route({\n        method: ['GET', 'POST'],\n        path: '/login',\n        config: {\n            auth: {\n                strategy: 'twitter',\n                mode: 'try'\n            },\n            handler: function (request, reply) {\n\n                if (!request.auth.isAuthenticated) {\n                    return reply('Authentication failed due to: ' + request.auth.error.message);\n                }\n\n                return reply.redirect('/home');\n            }\n        }\n    });\n\n    server.start();\n});\n```\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/hapijs/bell/issues"
  },
  "homepage": "https://github.com/hapijs/bell",
  "_id": "bell@2.2.0",
  "_shasum": "b0367041ecd5b10048ea6b982a0b275a567cfddb",
  "_from": "https://registry.npmjs.org/bell/-/bell-2.2.0.tgz",
  "_resolved": "https://registry.npmjs.org/bell/-/bell-2.2.0.tgz"
}
